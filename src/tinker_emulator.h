static double emu_tinker_bias_y[40][4] = {
    {0.22772415000000001,-0.37692982250000007,-0.0402944999999999,0.04022747500000001},
    {-0.28278585,0.19515017749999994,0.04740549999999999,-0.06182552499999994},
    {0.3212841500000001,-0.8808398225,-0.11989450000000001,0.06898547500000007},
    {0.17846414999999993,-0.6810798225000001,-0.09233449999999999,0.05497347500000005},
    {0.4098541499999999,-0.5539598225000001,-0.07733450000000008,0.0647434750000001},
    {-0.76878285,0.5381131774999999,0.08117550000000007,-0.06465652499999996},
    {0.40140415000000007,-0.5459038225,-0.08968449999999994,0.08774847500000005},
    {0.24942415000000007,0.026990177499999934,-0.019294499999999992,0.03807147500000008},
    {-0.39614284999999994,0.11911017749999997,0.04924550000000005,-0.06747352499999992},
    {0.3164341500000001,-0.16069982250000003,-0.03416449999999993,0.033380475000000076},
    {-0.2499258499999999,0.5025871774999999,0.06269550000000002,-0.06842252499999996},
    {-0.12223585000000003,-0.3533408225000001,-0.03049450000000009,0.017900475000000027},
    {0.2607141500000001,-0.11666582250000002,-0.012854499999999991,0.03635147500000002},
    {0.08741415000000008,0.26517217749999994,0.04785550000000005,-0.043800524999999924},
    {-0.76097985,0.24849317749999994,0.05062549999999999,-0.022498524999999936},
    {-0.06336585000000006,0.5376801775,0.07865549999999999,-0.07991652499999996},
    {-0.09263584999999996,0.46694977749999994,0.041795500000000096,-0.038999524999999924},
    {-0.06395584999999993,0.5896181775,0.06771550000000004,-0.06875352499999993},
    {0.37515414999999996,0.3734211774999999,0.02701550000000008,0.015070475000000028},
    {0.37989414999999993,0.42874727749999997,0.04378550000000003,-0.012818524999999914},
    {0.04260415000000006,-0.06311582250000008,0.01377549999999994,-0.017001524999999962},
    {0.15116415000000005,-0.18857682250000007,-0.031214499999999923,0.028068475000000093},
    {-0.46622184999999994,-0.00875982250000007,0.025565499999999908,-0.020490524999999926},
    {0.9793741499999999,-1.4424998225,-0.23205450000000005,0.1436824750000001},
    {0.5773441500000001,-0.40441882250000005,-0.06932450000000001,0.07315647500000011},
    {-0.0900458500000001,0.05627017749999996,-0.0025844999999999896,0.0005704750000000702},
    {-0.43227585,0.15328717749999995,0.048885499999999915,-0.061249524999999916},
    {0.06163414999999994,0.17322317749999994,0.002195500000000017,0.002554475000000056},
    {-1.11435885,0.6018431774999999,0.10177550000000002,-0.051648524999999945},
    {-0.58425185,0.33632737749999997,0.06437549999999992,-0.06131052499999995},
    {-0.05438585000000007,0.5742031774999999,0.06327550000000004,-0.05677052499999996},
    {-0.46905785,0.5551571774999999,0.08878549999999996,-0.09477352499999991},
    {0.48297415,0.06671617749999992,-0.005604500000000012,0.03804847500000008},
    {0.10267414999999991,-0.12002582250000005,-0.021424499999999957,0.03506147500000001},
    {-0.2600958499999999,0.08162417749999995,0.021935500000000108,-0.03365652499999994},
    {0.7054041500000001,-1.0345198225,-0.15660450000000004,0.13090447500000002},
    {-0.49813684999999996,0.16804117749999994,0.04431549999999995,-0.04419252499999993},
    {-0.10155585,-0.29502082250000006,-0.039974500000000024,0.02313947500000002},
    {0.2226541500000001,0.20897417749999994,-0.0015045000000000197,0.01563147500000006},
    {0.33760415,-0.04134282250000004,0.003785499999999997,0.021988475000000007}
};
static double emu_tinker_bias_ymean[4] = {
    1.30796585, -0.39295018, -1.1741355 ,  0.52458352
};

static double emu_tinker_bias_cosmopars[40][7] = {
    {0.0226832,0.11406,-0.816597,0.975589,3.09292,63.3657,2.91875},
    {0.0224507,0.117258,-1.13444,0.976523,3.14987,73.0997,3.17375},
    {0.0229982,0.108749,-0.684659,0.99745,3.09377,63.7085,3.25875},
    {0.0226759,0.112306,-0.743738,0.948081,3.0009,64.0419,3.55625},
    {0.0220846,0.106252,-0.766605,0.965093,3.11856,65.0491,2.66375},
    {0.0206646,0.129503,-1.32636,0.927846,3.02365,72.7542,2.96125},
    {0.0229415,0.111503,-0.710308,0.970642,3.01597,62.6987,2.70625},
    {0.0228137,0.119597,-0.866603,0.966298,3.16214,64.3716,3.93875},
    {0.0206769,0.123835,-1.16373,0.949131,3.14713,69.4,3.59875},
    {0.0213439,0.115813,-0.830933,0.947523,3.07177,62.3564,3.89625},
    {0.0218933,0.128951,-1.24115,0.961017,3.05046,72.086,4.23625},
    {0.0226212,0.108951,-0.860928,0.996032,3.15811,67.734,2.83375},
    {0.022506,0.116766,-0.879472,0.953951,3.04801,65.3799,2.87625},
    {0.0218955,0.117176,-1.1195,0.978815,3.06781,71.0834,3.00375},
    {0.0226491,0.127108,-1.11683,0.972365,3.09389,68.73,2.74875},
    {0.0214676,0.128502,-1.30291,0.933567,3.0943,74.1,3.72625},
    {0.0217741,0.120676,-1.1313,0.966216,3.01408,70.0743,3.76875},
    {0.0222812,0.119424,-1.24807,0.951972,3.03502,74.4391,3.21625},
    {0.0228741,0.11574,-1.03218,0.95331,3.0202,70.7516,4.27875},
    {0.0223826,0.113263,-1.09161,0.967291,3.09569,72.4296,3.68375},
    {0.0222537,0.122488,-0.989837,0.952888,3.11987,67.0552,3.38625},
    {0.0236151,0.117169,-0.865832,0.975785,3.13158,66.389,3.85375},
    {0.0215385,0.121009,-1.03161,0.958557,3.07232,68.0619,2.62125},
    {0.0227263,0.101218,-0.565849,0.974575,3.0192,62.0335,3.47125},
    {0.0224536,0.110277,-0.761456,0.958918,3.14394,63.0321,4.15125},
    {0.0209291,0.117057,-0.947878,0.934464,3.03679,65.7127,3.08875},
    {0.0223621,0.119181,-1.1251,0.94426,3.12789,71.7554,2.79125},
    {0.021358,0.113425,-0.964588,0.966388,3.01471,67.393,4.02375},
    {0.0217472,0.131777,-1.39992,0.95857,3.14656,74.7675,3.81125},
    {0.0223248,0.128915,-1.23607,0.940146,3.15905,71.4136,3.42875},
    {0.0219279,0.123914,-1.22368,0.955236,3.11828,73.4315,4.06625},
    {0.0212396,0.127579,-1.38165,0.956072,3.07641,73.76,3.34375},
    {0.0224969,0.112845,-0.925758,0.949484,3.04281,68.4034,3.98125},
    {0.0233732,0.11497,-0.875221,0.989173,3.14916,66.0523,3.64125},
    {0.0227557,0.122229,-1.03229,0.950028,3.10694,69.0704,3.13125},
    {0.0234108,0.107641,-0.61282,0.995568,3.14029,61.6947,3.04625},
    {0.0219989,0.121297,-1.10822,0.967361,3.17942,70.4113,3.30125},
    {0.0228745,0.109744,-0.848746,0.977623,3.07229,66.7262,3.51375},
    {0.0237124,0.114975,-0.955008,0.976591,3.05351,69.7468,4.10875},
    {0.0217407,0.12007,-0.941053,0.960207,3.0927,64.7043,4.19375}
};

static double emu_tinker_bias_variances[40][4] = {
    {0.0072293,0.00439722,2.81818e-06,4.74412e-05},
    {0.00699877,0.00269795,7.42337e-07,2.39677e-05},
    {0.0110443,0.00711122,4.65542e-06,0.000112801},
    {0.0106216,0.0102302,4.31172e-06,0.000103383},
    {0.00724683,0.00524066,4.31665e-06,6.43917e-05},
    {0.0106784,0.00234987,5.0869e-06,6.98768e-05},
    {0.00854694,0.00664262,5.57295e-06,8.14472e-05},
    {0.00686848,0.0047873,3.72477e-06,5.69853e-05},
    {0.00724118,0.00248583,8.77754e-07,2.31016e-05},
    {0.00877297,0.00692596,6.01501e-06,9.17487e-05},
    {0.00627794,0.00336004,9.26898e-07,2.86192e-05},
    {0.00788265,0.00320692,8.60393e-07,2.75182e-05},
    {0.00645664,0.00441144,3.48456e-06,5.00461e-05},
    {0.00516963,0.0030301,1.88609e-06,2.83136e-05},
    {0.00627674,0.002754,3.41576e-06,5.52287e-05},
    {0.00476999,0.00279074,1.30704e-06,2.45841e-05},
    {0.00625622,0.00428272,1.611e-06,3.75563e-05},
    {0.00486567,0.00359014,1.30515e-06,2.83193e-05},
    {0.00793602,0.00820381,8.56658e-06,0.000112397},
    {0.00547263,0.00462295,5.10187e-06,6.12737e-05},
    {0.00639258,0.00334604,1.60622e-06,3.16773e-05},
    {0.00728083,0.00523552,2.64198e-06,5.18353e-05},
    {0.0114682,0.00289903,2.18067e-06,3.56099e-05},
    {0.0289611,0.0255266,5.05678e-05,0.000513587},
    {0.0115307,0.00948345,1.29089e-05,0.000154464},
    {0.00693994,0.00459213,1.46837e-06,3.85683e-05},
    {0.00863687,0.00262847,1.12103e-06,2.78236e-05},
    {0.00777637,0.00787936,3.47484e-06,7.01753e-05},
    {0.00742029,0.00223942,1.12076e-05,0.000137364},
    {0.00756381,0.00224989,1.71963e-06,3.86059e-05},
    {0.00491035,0.00316571,1.4925e-06,3.04492e-05},
    {0.00734602,0.00208953,8.32388e-07,2.69424e-05},
    {0.00901434,0.00916022,1.04109e-05,0.000133636},
    {0.0066438,0.00432074,2.23461e-06,4.61122e-05},
    {0.00686723,0.00277957,7.85587e-07,2.64958e-05},
    {0.0119653,0.00774551,1.07802e-05,0.000130799},
    {0.00885545,0.00250722,1.62889e-06,3.42051e-05},
    {0.00961551,0.00626229,1.51812e-06,4.70177e-05},
    {0.00691408,0.00685252,4.84129e-06,7.6411e-05},
    {0.00646323,0.00500426,4.99086e-06,6.97103e-05}
};

static double emu_tinker_bias_rotation_matrix[4][4] = {
    {0.10646337980893085,0.021132636136643016,-0.97064255773295,-0.21464385751102177},
    {-0.978398102331227,-0.14405378008966646,-0.08332901175552901,-0.12264557715783554},
    {0.168930091936486,-0.9427314540214435,0.060196305393736965,-0.28124088332582375},
    {-0.053528741369879666,-0.3000988599285399,-0.21745276667457572,0.9272484253869187}
};


static double emu_tinker_bias_log_lambda[4][7] = {

    {-7.447915268014326,-7.464755353609271,-2.599556684860801,-5.8827162885183135,-3.4939080354809984,22.358830230679345,2.032157502031441},
    {-8.23942986061086,13.078292333315005,-1.6453454526931253,24.55006207730737,-2.208502981716542,6.529841736884682,2.702316841471984},
    {-2.3990180929022267,-4.984895914479709,0.6207751414355313,24.725128904515856,6.6630793421725425,6.460552261861607,5.096751130041617},
    {-4.200230133222608,-3.9710113322602116,2.102438559177407,23.3325814549079,5.148802333913723,10.75333618297953,9.909683276181012},

};


static double  emu_tinker_hmf_y[40][6] = {
    {-0.1448425374119484,-0.08926351387358428,-0.07078067938224142,-0.0751793656084827,-0.005018998750934589,-0.05225295235601757},
    {0.5049708471761837,0.0026595598904733397,-0.0038921241670490936,0.09560916154213095,-0.005794600558213681,0.05552364867783355},
    {-0.8627208958694558,-0.21529156442712571,-0.1208755452581971,-0.16535120476749132,-0.0033203498852933944,-0.1457749540357205},
    {-0.5826608728480172,-0.14714835005651916,-0.12846793980585702,-0.10943997170857644,0.00240879508846481,-0.0962217721844949},
    {-0.5545876430888952,-0.21979792210052296,-0.08807565586703991,-0.11072726416324458,-0.005273268347451454,-0.0911456817628149},
    {0.40158924641595894,0.13436053900444828,0.03569025165198525,0.13568445163568776,0.0028477517931705942,0.09561835132094099},
    {-0.7126669143565542,-0.19854990324928218,-0.08556983092129333,-0.1450095367760943,-0.004529677969020651,-0.12088921145858578},
    {-0.31869873207924715,0.0017834464129365124,0.021501364493547337,-0.044176536648269704,-0.0008765676143102641,-0.023319988337047626},
    {0.4957600717281972,0.1275121885983045,0.040691838254863,0.07574096130529395,0.0016677096691372628,0.06518735193847491},
    {0.135556991747705,-0.04576042599358415,-0.026101516175681017,-0.06425087485623127,0.006541173371379161,-0.02909732831970202},
    {0.18763465050007266,0.16966608858084356,0.08417902866322446,0.0931094798978438,0.003959100125876025,0.07973919365984905},
    {-0.24271688645153922,-0.13390914804184845,-0.03484760133125109,-0.05481465682918507,-0.008695031263514508,-0.040056201213015674},
    {-0.15978436202084045,-0.023507096649722503,0.005337926908883239,-0.04364841409106379,-0.0013866625726613457,-0.018383066647946755},
    {0.45418545561566004,0.044643589474832684,0.05059527356256899,0.06675143403373907,-0.0024229917161131542,0.05488029416954676},
    {0.20733127174820576,0.046596647489206694,0.01354725753386865,0.05689458812333659,-0.006444300601596453,0.04179765728831353},
    {0.30847484215695375,0.24565216540135842,0.10549643637054607,0.11948148374620227,0.005545901064651637,0.09862185012319613},
    {0.2239561865868691,0.1837759513156231,0.10972173523179429,0.05070458016533297,0.002655287769750325,0.05555691006433361},
    {0.5008271789158318,0.13671451835510853,0.0794051394077373,0.11385794060322418,0.001630193405091962,0.08559299813318377},
    {0.43184180513559145,0.08803925495035322,0.08564393051836006,0.013676568812944434,0.006555443520405213,0.03636738473725165},
    {0.38092691980999527,0.06101133033309403,0.06107219477355186,0.05742320269872725,0.0005629574805607884,0.051282706568338},
    {0.14590749695470767,-0.021433737489470917,-0.046348051131560375,0.01886950908482965,-0.0010212803353367716,0.020427915410562658},
    {0.19446514617129546,-0.08508578731667704,-0.06309135523584741,-0.04595190996717258,-0.0009228398603120525,-0.030863476438881765},
    {0.09064204716276697,0.008893208160631438,-0.006306418376440082,0.03076111328074449,-0.004757168834330361,0.027774840365751396},
    {-1.7442324842715164,-0.3040107853449356,-0.11014038090904044,-0.23375345276489778,0.010315086428079101,-0.28924774068634296},
    {-0.346916242169387,-0.15066310866761823,-0.12277364840686444,-0.09666508818430025,0.003980732716546198,-0.07405890333555032},
    {-0.05706659661681124,-0.013762985716764181,0.007142342690535153,-0.006261730669980148,0.001653240978116366,0.007109496155896844},
    {0.42670883439640095,0.034229532410572944,0.07157348702347044,0.06001570463634143,-0.001631644007138,0.05798276865969021},
    {0.23308173765822585,0.03942156114072087,0.07111322408410092,-0.013465941554071215,0.005940748977297294,0.018699096376212365},
    {0.39552826804190994,0.1571112179895482,0.03992033152254071,0.15687514712668815,-0.0003586000454304239,0.09939288528232126},
    {0.43700139696714246,0.08084668328890537,0.04150497704921918,0.09749816847844273,0.001436672494249558,0.08025834046637825},
    {0.45372185413053345,0.15427664803777957,0.04070877871987699,0.10330312703932643,0.0009131010090124292,0.07664475727826348},
    {0.20945914644184188,0.24096845402161818,0.0836498681786143,0.1434161807790736,0.0019392218639951442,0.09943320484339513},
    {-0.022630310516976948,0.04107321968172051,0.03554504463300012,-0.01556234943465884,0.003430065898727297,-0.0020332955987945045},
    {-0.05835823081973823,-0.06885210017093973,-0.03722829587296528,-0.04598255863641365,-0.0054196196878466,-0.028498787281381333},
    {0.04995893466631374,-0.0044218658092206875,-0.03268453196603649,0.03384400223092787,-0.002806129415857006,0.02709423964845792},
    {-1.0388357395627663,-0.3532818718470461,-0.18160377152890028,-0.23284787909259053,-0.0038141924992094456,-0.21459150855508158},
    {0.07072452926419925,0.10213408587828754,0.03198451261808988,0.05810915746940659,-0.0047538115689712,0.043830598887531935},
    {-0.09145505802111703,-0.0989521802594816,-0.027023282707441254,-0.058119550822858246,5.402385386960029e-05,-0.03858410704922721},
    {0.0415354800272037,0.018451006351282218,0.043126569645349,-0.009400425430336146,0.0011644872873375345,0.006185465935486967},
    {-0.043616833314955306,0.053871450246692765,0.02665911550797917,-0.01101725068432935,0.0040460407378233865,0.010017019269394911}
}; 
static double  emu_tinker_hmf_ymean[6] = {
    -0.38523973, -0.23606555, -0.99612066,  0.59285172, -0.4748609 ,
       -1.03035125
};
static double  emu_tinker_hmf_cosmopars[40][7] = {
    {0.02268325,0.1140598,-0.8165972,0.975589,3.092918,63.36569,2.91875},
    {0.02245071,0.1172576,-1.13444,0.9765227,3.149872,73.09972,3.17375},
    {0.0229982,0.1087487,-0.6846595,0.9974496,3.093773,63.70848,3.25875},
    {0.0226759,0.1123064,-0.7437379,0.9480812,3.0009,64.04189,3.55625},
    {0.02208455,0.1062517,-0.7666051,0.9650928,3.118565,65.04913,2.66375},
    {0.02066455,0.1295035,-1.326359,0.9278462,3.023645,72.75418,2.96125},
    {0.02294146,0.1115033,-0.7103081,0.9706424,3.015966,62.69873,2.70625},
    {0.02281365,0.1195969,-0.8666033,0.9662983,3.162138,64.37164,3.93875},
    {0.02067695,0.1238351,-1.163731,0.9491313,3.14713,69.39996,3.59875},
    {0.0213439,0.1158135,-0.830933,0.9475234,3.071769,62.35637,3.89625},
    {0.02189334,0.1289506,-1.241154,0.9610168,3.050463,72.08599,4.23625},
    {0.02262122,0.1089506,-0.8609277,0.9960324,3.158114,67.73404,2.83375},
    {0.02250605,0.1167658,-0.8794716,0.9539512,3.048009,65.37987,2.87625},
    {0.02189555,0.1171763,-1.119505,0.9788153,3.067809,71.08341,3.00375},
    {0.02264907,0.127108,-1.116826,0.9723654,3.093885,68.73003,2.74875},
    {0.0214676,0.1285016,-1.302908,0.9335675,3.094304,74.10001,3.72625},
    {0.02177406,0.1206762,-1.131299,0.9662156,3.014076,70.07432,3.76875},
    {0.02228121,0.1194239,-1.24807,0.9519719,3.035022,74.43912,3.21625},
    {0.02287409,0.1157403,-1.032177,0.9533103,3.020205,70.75163,4.27875},
    {0.0223826,0.1132626,-1.091607,0.9672909,3.095691,72.42955,3.68375},
    {0.02225371,0.122488,-0.9898374,0.9528876,3.119866,67.05524,3.38625},
    {0.02361513,0.117169,-0.8658316,0.9757853,3.131585,66.389,3.85375},
    {0.02153845,0.121009,-1.031605,0.9585567,3.072322,68.0619,2.62125},
    {0.0227263,0.1012181,-0.5658486,0.9745746,3.019204,62.0335,3.47125},
    {0.02245361,0.1102766,-0.7614561,0.958918,3.143937,63.03209,4.15125},
    {0.02092906,0.1170569,-0.9478782,0.9344636,3.036794,65.71267,3.08875},
    {0.02236205,0.1191811,-1.125103,0.9442601,3.127891,71.75536,2.79125},
    {0.02135801,0.1134255,-0.9645883,0.9663881,3.014713,67.39297,4.02375},
    {0.02174718,0.1317768,-1.399921,0.9585702,3.146559,74.76752,3.81125},
    {0.0223248,0.1289151,-1.236071,0.9401456,3.159051,71.41356,3.42875},
    {0.02192792,0.1239137,-1.223681,0.9552358,3.118282,73.43152,4.06625},
    {0.02123964,0.1275787,-1.381645,0.9560725,3.076413,73.75997,3.34375},
    {0.02249688,0.112845,-0.9257578,0.9494842,3.04281,68.40342,3.98125},
    {0.02337319,0.1149703,-0.8752207,0.9891731,3.149163,66.05231,3.64125},
    {0.02275573,0.1222293,-1.03229,0.9500281,3.10694,69.07038,3.13125},
    {0.02341077,0.1076406,-0.6128197,0.9955676,3.140289,61.69472,3.04625},
    {0.02199894,0.1212967,-1.108222,0.967361,3.179424,70.41129,3.30125},
    {0.02287447,0.109744,-0.8487455,0.9776227,3.072287,66.7262,3.51375},
    {0.02371239,0.1149747,-0.9550075,0.9765907,3.053508,69.7468,4.10875},
    {0.02174072,0.12007,-0.9410529,0.9602072,3.092704,64.7043,4.19375}
};
static double  emu_tinker_hmf_variances[40][6] = {
    {0.010673852482002345,0.00046798480442579774,0.00017467847283415307,2.7012057787330983e-05,6.395150030487421e-07,2.2766893376294157e-06},
    {0.008827158974180582,0.0004005139983218551,0.0001536558195765274,3.7022187174962865e-05,6.394108867331285e-07,2.3302193670444093e-06},
    {0.008881552838140332,0.0004854822481313546,0.00028272945934981893,4.5603601249133885e-05,7.44411569170835e-07,3.361335584464047e-06},
    {0.015631468321611715,0.0005186370124321004,0.0002779684980858573,4.0640051292854645e-05,1.3698772231512488e-06,4.41983225838059e-06},
    {0.0071579255048097885,0.00046632182809889025,0.0002346624764248678,3.0045597838724575e-05,7.487201305221795e-07,2.804480549618827e-06},
    {0.00921230627621941,0.0004382840845901532,0.00012979095352533444,2.4460360646284774e-05,5.802386134133656e-07,1.9164492759153556e-06},
    {0.008354490548401799,0.00043350283230417046,0.0002660159868131685,3.9053501751586074e-05,7.296050676861258e-07,3.055309372992131e-06},
    {0.013925795216475786,0.0004951032864210719,0.00020488464986968705,5.083889029922049e-05,7.6612576355772e-07,3.0189701371797245e-06},
    {0.012950508609188288,0.0005002233525907441,0.00013952902507193533,2.624297644038249e-05,6.540530076228591e-07,2.4919827268279457e-06},
    {0.017658653909990576,0.0005723646607896582,0.00020783758227426745,4.049639843252304e-05,7.467266255072059e-07,3.284895748250808e-06},
    {0.011959275065952573,0.0005177787233680625,0.00015716810684461915,2.9259516244500757e-05,6.486852588238653e-07,2.513793739476694e-06},
    {0.007649577605876405,0.0004570440637656539,0.00019576334915241922,2.6039239006166566e-05,6.640634647177973e-07,2.5068620896346556e-06},
    {0.01188892482860092,0.0004944292677952407,0.00017459857065732924,3.881278023306219e-05,6.635679908451106e-07,2.618967474667594e-06},
    {0.010063701361638058,0.0004912833754830611,0.00016813410774478172,3.068882135232064e-05,6.458158646781259e-07,2.36246313586171e-06},
    {0.0084298751785264,0.0004239389101525655,0.0001365298918166319,2.255562003238831e-05,5.383695179298085e-07,2.1243419953304654e-06},
    {0.015170873666741785,0.0005619537193694456,0.00015427755905639116,3.555964504229281e-05,8.100620006583512e-07,3.5210969275095153e-06},
    {0.017866465755686387,0.0005376738190709837,0.00016611915798593247,5.784251942259392e-05,6.608451021519631e-07,3.4486829315953135e-06},
    {0.013515101714306723,0.0005122927482154446,0.000158813214448998,3.3318784715559786e-05,6.844697911528025e-07,2.3935111412334284e-06},
    {0.021856968997306204,0.0006557183331200173,0.0001962600730261972,6.150962458140364e-05,8.399662479924088e-07,3.941285547606939e-06},
    {0.014097095074583203,0.0005553159235975108,0.0001704111778257908,3.517347476320707e-05,7.585461116271191e-07,2.4493389156114407e-06},
    {0.009197317357535454,0.00045085121635846505,0.00015050612419660294,2.6481768710675574e-05,5.810994071762222e-07,1.9630805130465273e-06},
    {0.013381982956195354,0.0005210876742147055,0.00017225017876898235,3.2817200511865766e-05,6.458454164563925e-07,2.7854734201441493e-06},
    {0.008384204264675605,0.00044712567211264905,0.00014009293208827286,2.1728031430226934e-05,6.320807807935231e-07,2.1172880151341966e-06},
    {0.010888732070297434,0.0006756151358545425,0.0006548202079470336,0.00015095263487116967,1.8038991105249442e-06,5.873957493576055e-06},
    {0.013552716090913885,0.0005458127713546687,0.00027583594375122153,3.2400326231803935e-05,1.1948260317170459e-06,4.100136647231383e-06},
    {0.01156802796212998,0.0005063809139224696,0.00016898813451541125,2.9683800551907087e-05,6.57168993791333e-07,2.483548230579129e-06},
    {0.011023504645581297,0.0004944207667942137,0.00015514507484018573,3.0159075643334834e-05,6.768300641789678e-07,2.514628247171993e-06},
    {0.019422842711884252,0.0005808098497112562,0.00020063874191731583,5.805487712749673e-05,7.51575605956473e-07,3.1881583205626474e-06},
    {0.009302443488415557,0.0003888752987542511,0.00014352188912062478,2.555085484925829e-05,6.222622069889892e-07,2.0642252953324567e-06},
    {0.00969617675844348,0.00043154558491441045,0.00013395094175301965,2.4403993662728332e-05,6.136798212969655e-07,2.041715791671731e-06},
    {0.012845616529645106,0.0005087066633681586,0.00014420341043015663,2.5968319027213836e-05,6.248745939623833e-07,2.2556957457076304e-06},
    {0.011657535762413936,0.0005410378923877864,0.00013351645183336716,2.8458624279310755e-05,6.976978319867865e-07,2.9631117706124664e-06},
    {0.019937379105613384,0.0006024418065733652,0.00023991520135986373,5.476553903917764e-05,9.172906899301209e-07,3.1848868251077847e-06},
    {0.010760196669072429,0.0004832216053309568,0.00017814918401465736,2.8420926132106625e-05,6.517196438738184e-07,2.1302492383890935e-06},
    {0.008661455037213401,0.00044774955649375234,0.0001589524574186085,2.2460829416031938e-05,5.611646800551189e-07,1.8469299391794318e-06},
    {0.007321177953696668,0.00044004293168246655,0.00031087861472038993,4.2853350803064255e-05,8.073940049523249e-07,3.4675484917597975e-06},
    {0.010898175295693575,0.00043190723412281086,0.00014221070648060078,2.729301349190904e-05,6.50170935520673e-07,2.80068778545517e-06},
    {0.01327858999529872,0.00043110477155543605,0.00020258714196678526,3.5497415527814504e-05,8.035724549765251e-07,2.8812387137647917e-06},
    {0.0165501554244647,0.0005103983314302783,0.00019233444823768536,4.197289531746676e-05,8.630685109860523e-07,2.7409440174096753e-06},
    {0.014565745772759667,0.0005016926197036169,0.0001846771129267545,4.1052865746208405e-05,6.752650848300221e-07,2.526548871458232e-06}
};
static double  emu_tinker_hmf_rotation_matrix[6][6] = {
    {0.08704382607694865,-0.11089859800237231,-0.7957023350728339,0.4019836556297265,-0.30232521071967156,0.3065799648256448},
    {-0.03044879278787779,0.07000980824832856,0.19507306859624995,-0.06401461131008807,-0.9305469076110506,-0.2934324078038807},
    {0.015966421888820068,-0.022466466074160647,-0.3113260491783341,0.21492097427739587,0.20243794896651182,-0.9028534067117938},
    {-0.9527749729274992,0.2578614433179804,-0.06052367811987884,0.1432531642850466,0.016845183611672112,0.03548213791787295},
    {-0.1757206437441082,-0.8170222169795925,0.3267291828577247,0.44096348952049264,-0.01920743448699522,0.00522195015010505},
    {-0.22931075652239732,-0.49827458155518906,-0.34851873468589406,-0.7570666924342047,-0.03237453886259785,-0.05895440892959973}
};
static double  emu_tinker_hmf_log_lambda[6][7] = {
    {11.819136690440798,-7.86347679921291,-1.3489001790458712,21.807349120065773,23.709856659737703,31.240068804362995,26.488654103499925},
    {-5.205813650960261,-5.3471611379606125,1.3406162460465807,57.12272516043868,2.5464397999063526,24.42599039395141,5.976394443911121},
    {14.05534511533479,-1.7171558279243262,0.6946689314297985,26.866192082546736,2.781428732208767,32.33561819944564,7.274240049786457},
    {26.816850637377595,27.921071577528433,0.2333998509953095,6.862039968911631,32.13592499751718,33.323998526091344,35.62887807108435},
    {0.26265129214647404,4.38943235789435,1.6315429514189743,4.650995934050422,7.668707045752652,31.983629382281514,9.301385973549714},
    {15.016994502681213,-3.434459008144309,-0.8016733530916551,3.29640846737543,27.753946617704653,11.316750811512485,11.166652716045194}
};



typedef struct {
    int tinker_bias_ncosmo;
    int tinker_bias_nparam;
    int tinker_bias_nsamp;
    int tinker_bias_nparam_redshift;
    int tinker_hmf_ncosmo;
    int tinker_hmf_nparam;
    int tinker_hmf_nsamp;
    int tinker_hmf_nparam_redshift;
} TinkerEmuParam;

TinkerEmuParam tinkerEmuParam = {
    .tinker_bias_ncosmo=7, //do not change
    .tinker_bias_nparam=4, // do not change
    .tinker_bias_nsamp=40, 
    .tinker_bias_nparam_redshift = 6, // number of parameters of equation 7 in 1907.13167.; 
    .tinker_hmf_ncosmo=7, //do not change
    .tinker_hmf_nparam=6, // do not change
    .tinker_hmf_nsamp=40, 
    .tinker_hmf_nparam_redshift = 4 // number of parameters of eq 2 in 1804.05866; 
};

